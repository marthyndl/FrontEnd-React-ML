{"ast":null,"code":"import _regeneratorRuntime from \"/home/tincho/Documentos/Projects/React/FrontEnd-React-ML/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/tincho/Documentos/Projects/React/FrontEnd-React-ML/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/tincho/Documentos/Projects/React/FrontEnd-React-ML/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/tincho/Documentos/Projects/React/FrontEnd-React-ML/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/tincho/Documentos/Projects/React/FrontEnd-React-ML/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/tincho/Documentos/Projects/React/FrontEnd-React-ML/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/tincho/Documentos/Projects/React/FrontEnd-React-ML/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/tincho/Documentos/Projects/React/FrontEnd-React-ML/src/components/ProductList.js\";\nimport React, { Component } from 'react';\nimport queryString from 'query-string';\nimport ML from '../api/ML';\nimport history from \"../history\";\nimport NotFound from './NotFound';\nimport Breadcrumb from './Breadcrumb';\nimport ProductItem from './ProductItem';\n\nvar ProductList =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(ProductList, _Component);\n\n  function ProductList() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, ProductList);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ProductList)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      error: false,\n      products: [],\n      categories: []\n    };\n\n    _this.onProductSelect = function (_ref) {\n      var id = _ref.id;\n      history.push({\n        pathname: \"/items/\".concat(id)\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(ProductList, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      if (this.props.location) {\n        var query = queryString.parse(this.props.location.search, {\n          ignoreQueryPrefix: true\n        }).search;\n        if (query) this.fetchProducts(query);\n      }\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(_ref2) {\n      var location = _ref2.location;\n      this.setState({\n        error: false\n      });\n\n      if (location) {\n        var query = queryString.parse(location.search, {\n          ignoreQueryPrefix: true\n        }).search;\n        if (query) this.fetchProducts(query);\n      }\n    }\n  }, {\n    key: \"fetchProducts\",\n    value: function () {\n      var _fetchProducts = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee(query) {\n        var _ref3, data, response;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return ML.get('/api/items', {\n                  params: {\n                    q: query\n                  }\n                });\n\n              case 3:\n                _ref3 = _context.sent;\n                data = _ref3.data;\n                this.setState({\n                  products: data.items,\n                  categories: data.categories\n                });\n                _context.next = 12;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](0);\n                response = _context.t0.response;\n\n                if (response.data.status === 404 || response.data.status === 400) {\n                  this.setState({\n                    error: true\n                  });\n                }\n\n              case 12:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 8]]);\n      }));\n\n      function fetchProducts(_x) {\n        return _fetchProducts.apply(this, arguments);\n      }\n\n      return fetchProducts;\n    }()\n  }, {\n    key: \"renderProducts\",\n    value: function renderProducts() {\n      var _this2 = this;\n\n      var products = this.state.products;\n\n      if (!products) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 56\n          },\n          __self: this\n        });\n      }\n\n      return products.map(function (product) {\n        return React.createElement(ProductItem, {\n          key: product.id,\n          product: product,\n          onProductSelect: function onProductSelect() {\n            return _this2.onProductSelect(product);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 60\n          },\n          __self: this\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(\"div\", {\n        className: \"container d-flex flex-column\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 66\n        },\n        __self: this\n      }, React.createElement(NotFound, {\n        show: this.state.error,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 67\n        },\n        __self: this\n      }), React.createElement(Breadcrumb, {\n        elements: this.state.categories,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 68\n        },\n        __self: this\n      }), React.createElement(\"div\", {\n        className: \"flex-grow-1\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69\n        },\n        __self: this\n      }, this.renderProducts()));\n    }\n  }]);\n\n  return ProductList;\n}(Component);\n\nexport default withRouter(ProductList);","map":{"version":3,"sources":["/home/tincho/Documentos/Projects/React/FrontEnd-React-ML/src/components/ProductList.js"],"names":["React","Component","queryString","ML","history","NotFound","Breadcrumb","ProductItem","ProductList","state","error","products","categories","onProductSelect","id","push","pathname","props","location","query","parse","search","ignoreQueryPrefix","fetchProducts","setState","get","params","q","data","items","response","status","map","product","renderProducts","withRouter"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport queryString from 'query-string';\nimport ML from '../api/ML';\nimport history from \"../history\";\nimport NotFound from './NotFound';\nimport Breadcrumb from './Breadcrumb';\nimport ProductItem from './ProductItem';\n\nclass ProductList extends Component {\n    state = {\n        error: false,\n        products: [],\n        categories: [],        \n    };\n\n    componentDidMount(){\n        if(this.props.location){\n            let query = queryString.parse(this.props.location.search, { ignoreQueryPrefix: true })\n                .search;\n            if(query) this.fetchProducts(query);\n\n        }\n    }\n\n    componentWillReceiveProps({location}) {\n        this.setState({error:false});\n        if(location){\n            let query = queryString.parse(location.search, { ignoreQueryPrefix: true }).search;\n            if(query) this.fetchProducts(query);\n        }\n    }\n\n    async fetchProducts(query){\n        try {\n            let {data} = await ML.get('/api/items', {\n                params: { q: query }\n            });\n\n            this.setState({ products: data.items, categories: data.categories});\n        } catch ({response}){\n            if(response.data.status === 404 || response.data.status === 400){\n                this.setState({error: true})\n            }\n        }\n\n    }\n\n    onProductSelect = ({id}) => {\n        history.push({ pathname: `/items/${id}` });\n    }\n\n    renderProducts(){\n\n        const { products } = this.state;\n        if(!products){\n            return <div></div>\n        }\n\n        return products.map( product => {\n            return <ProductItem key={product.id} product={product} onProductSelect={() => this.onProductSelect(product)}/>\n        })\n    }\n\n    render(){\n        return (\n            <div className=\"container d-flex flex-column\">\n                <NotFound show={this.state.error}/>\n                <Breadcrumb elements={this.state.categories}/>\n                <div className=\"flex-grow-1\">\n                    {this.renderProducts()}\n                </div>\n            </div>\n        )\n    }\n}\n\nexport default withRouter(ProductList);"]},"metadata":{},"sourceType":"module"}